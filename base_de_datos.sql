
-- MySQL Script generated by MySQL Workbench
-- Wed Oct 30 13:55:35 2024
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- Schema fastpacket
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema fastpacket
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `fastpacket` ;
USE `fastpacket` ;

-- -----------------------------------------------------
-- Table `fastpacket`.`rol`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`rol` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`rol` (
  `idRol` INT NOT NULL,
  `nombre` VARCHAR(45) NULL,
  PRIMARY KEY (`idRol`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`tipo`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`tipo` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`tipo` (
  `idTipo` INT NOT NULL,
  `nombre` VARCHAR(45) NULL,
  PRIMARY KEY (`idTipo`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`unidad`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`unidad` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`unidad` (
  `idUnidad` INT NOT NULL AUTO_INCREMENT,
  `marca` VARCHAR(45) NOT NULL,
  `modelo` VARCHAR(45) NOT NULL,
  `ano` INT NOT NULL,
  `vin` VARCHAR(45) NOT NULL,
  `numeroIdentificacion` VARCHAR(45) NOT NULL,
  `idTipo` INT NOT NULL,
  `motivo` VARCHAR(45) NULL,
  `activo` VARCHAR(45) NULL,
  PRIMARY KEY (`idUnidad`),
  UNIQUE INDEX `vin_UNIQUE` (`vin` ASC) VISIBLE,
  UNIQUE INDEX `numeroIdentificacion_UNIQUE` (`numeroIdentificacion` ASC) VISIBLE,
  INDEX `fk_unidad_tipo_idx` (`idTipo` ASC) VISIBLE,
  CONSTRAINT `fk_unidad_tipo`
    FOREIGN KEY (`idTipo`)
    REFERENCES `fastpacket`.`tipo` (`idTipo`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`colaborador`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`colaborador` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`colaborador` (
  `idColaborador` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `apellidoPaterno` VARCHAR(45) NOT NULL,
  `apellidoMaterno` VARCHAR(45) NOT NULL,
  `curp` VARCHAR(45) NOT NULL,
  `correo` VARCHAR(45) NOT NULL,
  `numeroPersonal` VARCHAR(45) NOT NULL,
  `contrasena` VARCHAR(45) NOT NULL,
  `fotografia` LONGBLOB NULL,
  `numeroLicencia` VARCHAR(45) NULL,
  `idRol` INT NOT NULL,
  `idUnidad` INT NULL,
  PRIMARY KEY (`idColaborador`),
  UNIQUE INDEX `curp_UNIQUE` (`curp` ASC) VISIBLE,
  UNIQUE INDEX `correo_UNIQUE` (`correo` ASC) VISIBLE,
  UNIQUE INDEX `numeroPersonal_UNIQUE` (`numeroPersonal` ASC) VISIBLE,
  INDEX `fk_colaborador_rol1_idx` (`idRol` ASC) VISIBLE,
  INDEX `fk_colaborador_unidad1_idx` (`idUnidad` ASC) VISIBLE,
  CONSTRAINT `fk_colaborador_rol1`
    FOREIGN KEY (`idRol`)
    REFERENCES `fastpacket`.`rol` (`idRol`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_colaborador_unidad1`
    FOREIGN KEY (`idUnidad`)
    REFERENCES `fastpacket`.`unidad` (`idUnidad`)
    ON DELETE SET NULL
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`cliente`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`cliente` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`cliente` (
  `idCliente` INT NOT NULL AUTO_INCREMENT,
  `nombre` VARCHAR(45) NOT NULL,
  `apellidoPaterno` VARCHAR(45) NOT NULL,
  `apellidoMaterno` VARCHAR(45) NOT NULL,
  `direccion` VARCHAR(100) NOT NULL,
  `telefono` VARCHAR(45) NOT NULL,
  `correo` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`idCliente`),
  UNIQUE INDEX `correo_UNIQUE` (`correo` ASC) VISIBLE)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`estado`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`estado` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`estado` (
  `idEstado` INT NOT NULL,
  `nombre` VARCHAR(45) NULL,
  PRIMARY KEY (`idEstado`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`envio`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`envio` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`envio` (
  `idEnvio` INT NOT NULL AUTO_INCREMENT,
  `origenDireccion` VARCHAR(100) NOT NULL,
  `destinoDireccion` VARCHAR(45) NOT NULL,
  `numeroGuia` VARCHAR(45) NOT NULL,
  `costo` VARCHAR(45) NOT NULL,
  `fechaActualizacion` DATE NOT NULL,
  `idEstado` INT NOT NULL,
  `idColaborador` INT NULL,
  `idCliente` INT NOT NULL,
  PRIMARY KEY (`idEnvio`),
  UNIQUE INDEX `numeroGuia_UNIQUE` (`numeroGuia` ASC) VISIBLE,
  INDEX `fk_envio_estado1_idx` (`idEstado` ASC) VISIBLE,
  INDEX `fk_envio_colaborador1_idx` (`idColaborador` ASC) VISIBLE,
  INDEX `fk_envio_cliente1_idx` (`idCliente` ASC) VISIBLE,
  CONSTRAINT `fk_envio_estado1`
    FOREIGN KEY (`idEstado`)
    REFERENCES `fastpacket`.`estado` (`idEstado`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_envio_colaborador1`
    FOREIGN KEY (`idColaborador`)
    REFERENCES `fastpacket`.`colaborador` (`idColaborador`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_envio_cliente1`
    FOREIGN KEY (`idCliente`)
    REFERENCES `fastpacket`.`cliente` (`idCliente`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`paquete`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`paquete` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`paquete` (
  `idPaquete` INT NOT NULL AUTO_INCREMENT,
  `descripcion` VARCHAR(45) NOT NULL,
  `peso` VARCHAR(45) NOT NULL,
  `alto` VARCHAR(45) NOT NULL,
  `ancho` VARCHAR(45) NOT NULL,
  `profundidad` VARCHAR(45) NOT NULL,
  `idEnvio` INT NOT NULL,
  PRIMARY KEY (`idPaquete`),
  INDEX `fk_paquete_envio1_idx` (`idEnvio` ASC) VISIBLE,
  CONSTRAINT `fk_paquete_envio1`
    FOREIGN KEY (`idEnvio`)
    REFERENCES `fastpacket`.`envio` (`idEnvio`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `fastpacket`.`historial`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `fastpacket`.`historial` ;

CREATE TABLE IF NOT EXISTS `fastpacket`.`historial` (
  `id` INT NOT NULL,
  `fechaCambio` DATE NULL,
  `comentario` TEXT NULL,
  `idEnvio` INT NULL,
  `idColaborador` INT NULL,
  `idRol` INT NULL,
  PRIMARY KEY (`id`),
  INDEX `fk_historial_envio1_idx` (`idEnvio` ASC) VISIBLE,
  INDEX `fk_historial_colaborador1_idx` (`idColaborador` ASC) VISIBLE,
  INDEX `fk_historial_rol1_idx` (`idRol` ASC) VISIBLE,
  CONSTRAINT `fk_historial_envio1`
    FOREIGN KEY (`idEnvio`)
    REFERENCES `fastpacket`.`envio` (`idEnvio`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_historial_colaborador1`
    FOREIGN KEY (`idColaborador`)
    REFERENCES `fastpacket`.`colaborador` (`idColaborador`)
    ON DELETE CASCADE
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_historial_rol1`
    FOREIGN KEY (`idRol`)
    REFERENCES `fastpacket`.`rol` (`idRol`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;


-- ---------------------------------------------------
-- inserts
-- -----------------------------------------------------
-- Insert data into `rol` table (ensure these roles exist)
INSERT INTO `fastpacket`.`rol` (`idRol`, `nombre`) VALUES
(1, 'Administrador'),
(2, 'Ejecutivo de tienda'),
(3, 'Conductor');

-- Insert data into `estado` table (ensure these states exist)
INSERT INTO `fastpacket`.`estado` (`idEstado`, `nombre`) VALUES
(1, 'Pendiente'),
(2, 'En transito'),
(3, 'Detenido'),
(4, 'Cancelado'),
(5,'Entregado');

-- Insert data into `tipo` table (ensure these types exist)
INSERT INTO `fastpacket`.`tipo` (`idTipo`, `nombre`) VALUES
(1, 'Gasolina'),
(2, 'Diesel'),
(3, 'Electrica'),
(4,'Hibrida');

-- Insert data into `unidad` table
INSERT INTO `fastpacket`.`unidad` (`idUnidad`, `marca`, `modelo`, `ano`, `vin`, `numeroIdentificacion`, `idTipo`) VALUES
(NULL, 'Chevrolet', 'Silverado', 2020, '1GC1KUEY5LF160181', '20201GC', 3),
(NULL, 'Honda', 'Civic', 2019, '2HGFC2F59KH123456', '20192HG', 1);


-- Insert data into `colaborador` table
INSERT INTO `fastpacket`.`colaborador` (`idColaborador`, `nombre`, `apellidoPaterno`, `apellidoMaterno`, `curp`, `correo`, `numeroPersonal`, `contrasena`, `fotografia`, `numeroLicencia`, `idRol`, `idUnidad`) VALUES
(NULL, 'Laura', 'Mendoza', 'Castillo', 'MECL880101HDFTSR09', 'laura.mendoza@example.com', '001', '123', NULL, null, 1,NULL),
(NULL, 'Pedro', 'Ramirez', 'Sanchez', 'RAMP900202HDFTSR02', 'pedro.ramirez@example.com', '002', '456', NULL, null, 2,NULL),
(NULL, 'Sofia', 'Martinez', 'López', 'MALS850303HDFTSR03', 'sofia.martinez@example.com', '003', '789', NULL, 'LIC003', 3, NULL);

-- Insert data into `cliente` table
INSERT INTO `fastpacket`.`cliente` (`idCliente`, `nombre`, `apellidoPaterno`, `apellidoMaterno`, `direccion`, `telefono`, `correo`) VALUES
(NULL, 'Jorge', 'Fernandez', 'Gutiérrez', '45 Pine St', '555-7890', 'jorge.fernandez@example.com'),
(NULL, 'Carla', 'Torres', 'Ramirez', '67 Maple St', '555-6789', 'carla.torres@example.com');

-- Inasert data into `envio` table
INSERT INTO `fastpacket`.`envio` (`idEnvio`, `origenDireccion`, `destinoDireccion`, `numeroGuia`, `costo`, `fechaActualizacion`, `idEstado`,`idCliente`) VALUES
(NULL, '123 Main St', '456 Oak St', 'GUIDE123', 12.50, '2024-10-29', 1,1),
(NULL, '789 Pine St', '101 Maple St', 'GUIDE456', 20.00, '2024-10-29', 2,1);

-- Insert data into `paquete` table
INSERT INTO `fastpacket`.`paquete` (`idPaquete`, `descripcion`, `peso`, `alto`, `ancho`, `profundidad`,`idEnvio`) VALUES
(null, 'Fragil', 0.75, 10.0, 15.0, 5.0,1),
(null, 'Pesado', 5.0, 20.0, 25.0, 10.0,2);

-- Insert data into `historial` table
INSERT INTO `fastpacket`.`historial` (`id`, `fechaCambio`, `comentario`, `idEnvio`, `idColaborador`, `idRol`) VALUES
(1, '2024-10-28', 'entrando', 1, 1, 1),
(2, '2024-10-29', 'en pendiente', 1, 2, 2),
(3, '2024-10-30', 'en transisto', 2, 3, 3);

CREATE USER 'yair'@'localhost' IDENTIFIED BY '123';
GRANT ALL PRIVILEGES ON fastpacket.* TO 'yair'@'localhost' WITH GRANT OPTION;
